<!DOCTYPE html>
<!--
 * Copyright (c) Microsoft. All rights reserved. Licensed under the MIT license.
 * See LICENSE in the project root for license information.
 -->
<html>

<head>

    <title>Outlook module extension sample</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-js/1.2.0/css/fabric.min.css" />
    <link rel="stylesheet" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-js/1.2.0/css/fabric.components.min.css" />
    <script src="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-js/1.2.0/js/fabric.min.js"></script>
    <!-- Extension specific style sheet -->
    <link rel="stylesheet" type="text/css" href="app.css" />

    <script type="text/javascript" src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-2.2.1.js"></script>
    <script src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js" type="text/javascript"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.6.1/angular.min.js" type="text/javascript"></script>
    <!-- Extension business logic is in this file -->
    <!-- <script type="text/javascript" src="sample.js"></script> -->

</head>

<body>


    <div class="ms-Persona">
        <div class="ms-Persona-imageArea">
            <img class="ms-Persona-image" src="https://dev.office.com/fabric-js/Components/Persona/Persona.Person2.png">
        </div>
        <div class="ms-Persona-presence">
            <i class="ms-Persona-presenceIcon ms-Icon ms-Icon--SkypeCheck"></i>
        </div>
        <div class="ms-Persona-details">
            <div class="ms-Persona-primaryText">Alton Lafferty</div>
            <div class="ms-Persona-secondaryText" id="previousMessage">Customer</div>
        </div>
    </div>

    <!-- <span class="ms-ListItem-primaryText">Alton Lafferty</span>  -->
    <!-- hello hello -->
    <!--<p class="ms-ListItem-primaryText">Lorem ipsum dolor sit amet, consectetur adipiscing elit. <span class="ms-ListItem-metaText">2:42p</span> -->


    <script type="text/javascript">
    var ListItemElements = document.querySelectorAll(".ms-ListItem");
    for (var i = 0; i < ListItemElements.length; i++) {
      //  new fabric['ListItem'](ListItemElements[i]);
    }
    </script>

    <div>&nbsp; </div>

    <div class="ms-TextField ms-TextField--multiline">
        <!--<label class="ms-Label">Name</label>-->
        <textarea class="ms-TextField-field" id="messageToSend"></textarea>
    </div>
    <script type="text/javascript">
    var TextFieldElements = document.querySelectorAll(".ms-TextField");
    for (var i = 0; i < TextFieldElements.length; i++) {
       // new fabric['TextField'](TextFieldElements[i]);
    }
    </script>

    <button class="ms-Button ms-Button--primary">
        <span class="ms-Button-label">Respond</span>
    </button>

    <script type="text/javascript">
    var ButtonElements = document.querySelectorAll(".ms-Button");
    for (var i = 0; i < ButtonElements.length; i++) {
        
        new fabric['Button'](ButtonElements[i], function () {
$.ajax({
    contentType : 'application/json',
  type: "POST",
  url: "/api/simulate",
  data:  '{ "Text" : "' + $("#messageToSend").val() +'"}',
  success: function (msg) {
      $("#messageToSend").val('');
       // $( ".result" ).html( "Data Saved: " + msg );
  },
  error: function(XMLHttpRequest, textStatus, errorThrown) {
    // $( ".result" ).html(errorThrown);
  }
});

        });
    }

    setInterval(function () {
        $.ajax({
            contentType: 'application/json',
            type: "GET",
            url: "/api/previousmessages",
            success: function (msg) {
                console.log(msg);
                $("#previousMessage").html('"' + msg +'"');
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
            }
        });
    }, 1000);

    </script>




</body>

</html>